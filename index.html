<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juniper Green Multiplayer</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1d1f27;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        h1 {
            font-size: 3rem;
            color: #ffdd57;
            margin-bottom: 20px;
        }
        .btn {
            padding: 15px 30px;
            background-color: #ffdd57;
            color: #1d1f27;
            font-size: 1.2rem;
            border: none;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s ease;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        }
        .btn:hover {
            background-color: #ffaa00;
        }
        .input-container {
            margin-bottom: 20px;
        }
        #gameGrid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
        }
        .grid-cell {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #333;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            border-radius: 8px;
        }
        .grid-cell.selected {
            background-color: #ffaa00;
            cursor: not-allowed;
        }
        footer {
            position: absolute;
            bottom: 10px;
            text-align: center;
            width: 100%;
            color: #ffdd57;
        }
        .flag-icon {
            width: 24px;
            margin-right: 5px;
        }
        .language-selector {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .language-selector select {
            margin-left: 10px;
            padding: 5px;
            font-size: 1rem;
        }
        .password-container {
            position: relative;
            display: inline-block;
        }
        .toggle-password {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            cursor: pointer;
            color: #aaa;
        }
    </style>
</head>
<body>
    <h1 id="title">Juniper Green Multiplayer</h1>

    <!-- Version Number -->
    <div id="version" style="position: absolute; top: 10px; right: 10px; color: #ffdd57;">
        Versione: 1.0.4
    </div>

    <!-- Sign-Up / Sign-In -->
    <div id="authPage" class="input-container">
        <button class="btn" onclick="showSignUp()">Sign-Up</button>
        <button class="btn" onclick="showSignIn()">Sign-In</button>
    </div>

    <!-- Sign-Up Form -->
    <div id="signUpPage" style="display: none;">
        <h2>Register</h2>
        <input type="email" id="emailSignUp" placeholder="Email" />
        <input type="text" id="usernameSignUp" placeholder="Nome utente" />
        <div class="password-container">
            <input type="password" id="passwordSignUp" placeholder="Password" />
            <span class="toggle-password" onclick="togglePassword('passwordSignUp')">üëÅÔ∏è</span>
        </div>
        <button class="btn" onclick="registerUser()">Register</button>
        <button class="btn" onclick="backToAuth()">Indietro</button>
    </div>

    <!-- Sign-In Form -->
    <div id="signInPage" style="display: none;">
        <h2>Login</h2>
        <input type="email" id="emailSignIn" placeholder="Email" />
        <div class="password-container">
            <input type="password" id="passwordSignIn" placeholder="Password" />
            <span class="toggle-password" onclick="togglePassword('passwordSignIn')">üëÅÔ∏è</span>
        </div>
        <button class="btn" onclick="loginUser()">Login</button>
        <button class="btn" onclick="backToAuth()">Indietro</button>
    </div>

    <!-- Main Menu -->
    <div id="mainPage" style="display: none;">
        <button class="btn" id="createGameBtn" onclick="showPage('gridSelectionPage')">Crea una Partita</button>
        <button class="btn" id="joinGameBtn" onclick="showPage('joinGamePage')">Entra in una Partita</button>
        <button class="btn" id="challengeComputerBtn" onclick="showPage('computerLevelPage')">Sfida il Computer</button>
        <button class="btn" id="settingsBtn" onclick="showPage('settingsPage')">Impostazioni</button>
        <button class="btn" id="changelogBtn" onclick="showPage('changelogPage')">Changelogs</button>
    </div>

    <!-- Pages -->
    <div id="gridSelectionPage" style="display: none;">
        <h2>Scegli la dimensione della griglia</h2>
        <button class="btn" onclick="startGame(10)">Griglia 10</button>
        <button class="btn" onclick="startGame(20)">Griglia 20</button>
        <button class="btn" onclick="startGame(30)">Griglia 30</button>
        <button class="btn" onclick="startGame(40)">Griglia 40</button>
        <button class="btn" onclick="startGame(50)">Griglia 50</button>
        <button class="btn" onclick="startGame(60)">Griglia 60</button>
        <button class="btn" onclick="startGame(70)">Griglia 70</button>
        <button class="btn" onclick="startGame(80)">Griglia 80</button>
        <button class="btn" onclick="startGame(90)">Griglia 90</button>
        <button class="btn" onclick="startGame(100)">Griglia 100</button>
    </div>

    <div id="computerLevelPage" style="display: none;">
        <h2>Scegli il livello del Computer</h2>
        <button class="btn" onclick="startGame(10, 'easy')">Facile</button>
        <button class="btn" onclick="startGame(10, 'medium')">Medio</button>
        <button class="btn" onclick="startGame(10, 'hard')">Difficile</button>
    </div>

    <div id="changelogPage" style="display: none;">
        <h2>üì¨ ChangeLogs - Version 1.0.3</h2>
        <ul id="changelogList">
            <li>Fixed button functionality</li>
            <li>Added show/hide password toggle</li>
            <li>Improved error handling for incorrect login</li>
            <li>Updated to version 1.0.3</li>
        </ul>
        <button class="btn" onclick="backToMain()">Indietro</button>
    </div>

    <div id="joinGamePage" style="display: none;">
        <h2>Inserisci il codice partita</h2>
        <input type="text" id="gameCodeInput" placeholder="Codice Partita" />
        <button class="btn" onclick="joinGame()">Entra</button>
        <button class="btn" onclick="backToMain()">Indietro</button>
    </div>

    <footer>Made with ‚ù§Ô∏è by Arciale</footer>

    <script>
        let registeredUsers = JSON.parse(localStorage.getItem('users')) || [];
        let currentUser = null;
        let currentGridSize = 10;

        function showSignUp() {
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('signUpPage').style.display = 'block';
        }

        function showSignIn() {
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('signInPage').style.display = 'block';
        }

                function registerUser() {
            const email = document.getElementById('emailSignUp').value;
            const username = document.getElementById('usernameSignUp').value;
            const password = document.getElementById('passwordSignUp').value;

            // Check if email already exists
            const existingUser = registeredUsers.find(user => user.email === email);
            if (existingUser) {
                alert("L'email √® gi√† registrata. Usa un'altra email.");
                return;
            }

            if (email && username && password) {
                registeredUsers.push({ email, username, password });
                localStorage.setItem('users', JSON.stringify(registeredUsers));
                alert('Registrazione avvenuta con successo!');
                backToAuth();
            } else {
                alert('Compila tutti i campi!');
            }
        }

        function loginUser() {
            const email = document.getElementById('emailSignIn').value;
            const password = document.getElementById('passwordSignIn').value;

            const user = registeredUsers.find(user => user.email === email && user.password === password);

            if (user) {
                currentUser = user;
                document.getElementById('signInPage').style.display = 'none';
                document.getElementById('mainPage').style.display = 'block';
            } else {
                alert('Credenziali non valide!');
                document.getElementById('emailSignIn').value = ''; // Clear email
                document.getElementById('passwordSignIn').value = ''; // Clear password
            }
        }

        function backToAuth() {
            document.getElementById('signUpPage').style.display = 'none';
            document.getElementById('signInPage').style.display = 'none';
            document.getElementById('authPage').style.display = 'block';
        }

        function saveSettings() {
            const playerColor = document.getElementById('playerColor').value;
            const opponentColor = document.getElementById('opponentColor').value;
            const language = document.getElementById('languageSelector').value;

            localStorage.setItem('playerColor', playerColor);
            localStorage.setItem('opponentColor', opponentColor);
            localStorage.setItem('language', language);

            changeLanguage(language);
            backToMain();
        }

        function changeLanguage(language) {
            const translations = {
                en: {
                    createGameBtn: "Create a Game",
                    joinGameBtn: "Join a Game",
                    challengeComputerBtn: "Challenge the Computer",
                    settingsBtn: "Settings",
                    changelogBtn: "Changelogs",
                    playerColor: "Player Color",
                    opponentColor: "Opponent Color"
                },
                it: {
                    createGameBtn: "Crea una Partita",
                    joinGameBtn: "Entra in una Partita",
                    challengeComputerBtn: "Sfida il Computer",
                    settingsBtn: "Impostazioni",
                    changelogBtn: "Changelogs",
                    playerColor: "Colore del giocatore",
                    opponentColor: "Colore avversario"
                },
                fr: {
                    createGameBtn: "Cr√©er une Partie",
                    joinGameBtn: "Rejoindre une Partie",
                    challengeComputerBtn: "D√©fier l'Ordinateur",
                    settingsBtn: "Param√®tres",
                    changelogBtn: "Changelogs",
                    playerColor: "Couleur du Joueur",
                    opponentColor: "Couleur de l'Adversaire"
                },
                es: {
                    createGameBtn: "Crear una Partida",
                    joinGameBtn: "Unirse a una Partida",
                    challengeComputerBtn: "Desafiar al Computador",
                    settingsBtn: "Ajustes",
                    changelogBtn: "Changelogs",
                    playerColor: "Color del Jugador",
                    opponentColor: "Color del Oponente"
                },
                de: {
                    createGameBtn: "Erstellen Sie ein Spiel",
                    joinGameBtn: "Spiel Beitreten",
                    challengeComputerBtn: "Computer Herausfordern",
                    settingsBtn: "Einstellungen",
                    changelogBtn: "Changelogs",
                    playerColor: "Spielerfarbe",
                    opponentColor: "Gegnerfarbe"
                }
            };

            document.getElementById("createGameBtn").textContent = translations[language].createGameBtn;
            document.getElementById("joinGameBtn").textContent = translations[language].joinGameBtn;
            document.getElementById("challengeComputerBtn").textContent = translations[language].challengeComputerBtn;
            document.getElementById("settingsBtn").textContent = translations[language].settingsBtn;
            document.getElementById("changelogBtn").textContent = translations[language].changelogBtn;
            document.getElementById("playerColor").labels[0].textContent = translations[language].playerColor;
            document.getElementById("opponentColor").labels[0].textContent = translations[language].opponentColor;
        }

        function showPage(pageId) {
            const pages = ['gridSelectionPage', 'computerLevelPage', 'changelogPage', 'settingsPage', 'joinGamePage'];
            pages.forEach(page => document.getElementById(page).style.display = 'none');
            document.getElementById(pageId).style.display = 'block';
        }

        function startGame(gridSize) {
            currentGridSize = gridSize;
            showPage('gamePage');
            setupGrid(gridSize);
        }

        function setupGrid(gridSize) {
            const gridContainer = document.getElementById('gameGrid');
            gridContainer.innerHTML = ''; // Clear previous grid

            for (let i = 1; i <= gridSize; i++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                cell.textContent = i;
                cell.onclick = () => selectNumber(i, cell);
                gridContainer.appendChild(cell);
            }
        }

        let currentPlayer = 1;
        let lastSelectedNumber = null;

        function selectNumber(number, cell) {
            if (cell.classList.contains('selected')) return;

            if (lastSelectedNumber !== null && !isValidMove(lastSelectedNumber, number)) {
                alert('Mossa non valida! Scegli un multiplo o un divisore del numero precedente.');
                return;
            }

            cell.classList.add('selected');
            lastSelectedNumber = number;

            if (checkGameOver()) {
                alert(`Gioco terminato! Il vincitore √® il Giocatore ${currentPlayer}`);
                return;
            }

            currentPlayer = currentPlayer === 1 ? 2 : 1;
            updateGameMessage();
        }

        function isValidMove(lastNumber, newNumber) {
            return newNumber % lastNumber === 0 || lastNumber % newNumber === 0;
        }

        function checkGameOver() {
            const cells = document.querySelectorAll('.grid-cell:not(.selected)');
            return Array.from(cells).every(cell => !isValidMove(lastSelectedNumber, parseInt(cell.textContent)));
        }

        function updateGameMessage() {
            document.getElementById('gameMessage').textContent = `√à il turno del Giocatore ${currentPlayer}`;
        }

        function quitGame() {
            location.reload();
        }

        function togglePassword(inputId) {
            const inputField = document.getElementById(inputId);
            const type = inputField.type === 'password' ? 'text' : 'password';
            inputField.type = type;
        }
    </script>
</body>
</html>
